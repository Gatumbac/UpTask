!function(){let t=[];!async function(){try{const e=`/api/tareas?id=${o()}`,n=await fetch(e),a=await n.json();t=a.tasks,i()}catch(t){console.log(t)}}();let e=[];const n={0:"Pendiente",1:"Completa"},a={0:"pending",1:"complete"};document.querySelector("#newtask-button").addEventListener("click",(function(){s()}));function s(e=!1,n={}){const a=document.createElement("DIV");a.classList.add("modal"),function(t,e,n){t.innerHTML=`\n            <form class="newtask-form" method='POST'>\n                <legend>${e?"Editar tarea":"Añade una nueva tarea"}</legend>\n                <div class="field">\n                    <label for="task">Tarea</label>\n                    <input\n                        type="text"\n                        name="name"\n                        id="task"\n                        placeholder="Nombre de la tarea"\n                        value="${n.name?n.name:""}"\n                    />\n                </div>\n\n                <div class="newtask-options">\n                    <input\n                        type="submit"\n                        class="newtask-submit"\n                        value="Guardar"\n                    />\n                    <button type="button" class="close-newtask">Cancelar</button>\n                </div>\n            </form>\n        `}(a,e,n),setTimeout((function(){document.querySelector(".newtask-form").classList.add("show")}),0),function(e,n,a){e.addEventListener("click",(function(s){s.preventDefault(),s.target.classList.contains("close-newtask")&&function(t){document.querySelector(".newtask-form").classList.add("close"),c(t,500)}(e),s.target.classList.contains("newtask-submit")&&function(e,n){const a=function(){const t=document.querySelector("#task").value.trim();if(t.length<4||t.length>60)return function(t,e,n){const a=document.querySelector(".alert");a&&a.remove();const s=document.createElement("DIV");s.textContent=t,s.classList.add("alert",e),n.parentElement.insertBefore(s,n.nextElementSibling),setTimeout((function(){s.remove()}),3e3)}("El nombre de la tarea es obligatorio y debe ser válido","error",document.querySelector(".newtask-form legend")),{name:"",result:!1};return{name:t,result:!0}}();if(!a.result)return;e?(n.name=a.name,d(n)):async function(e){const n=new FormData;n.append("name",e),n.append("project_id",o());try{const a="/api/tarea",s=await fetch(a,{method:"POST",body:n}),o=await s.json();"success"===o.type&&(c(document.querySelector(".modal"),0),Swal.fire("¡Tarea Creada!",o.message,"success"),function(e,n,a){const s={id:String(e),name:n,status:"0",project_id:a};t=[...t,s]}(o.id,e,o.projectId),i())}catch(t){console.log(t)}}(a.name)}(n,a)}))}(a,e,n),document.querySelector("BODY").appendChild(a)}function o(){const t=new URLSearchParams(window.location.search);return Object.fromEntries(t.entries()).id}function c(t,e){t&&setTimeout((function(){t.remove()}),e)}function i(){const c=document.querySelector("#tasks-list");!function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(c),function(){const e=t.filter((t=>"0"===t.status)),n=document.querySelector("#pending");0===e.length?n.disabled=!0:n.disabled=!1}(),function(){const e=t.filter((t=>"1"===t.status)),n=document.querySelector("#completed");0===e.length?n.disabled=!0:n.disabled=!1}();const r=e.length?e:t;if(0===r.length){const t=document.createElement("LI");return t.textContent="No existen tareas para mostrar",t.classList.add("no-tasks"),void c.appendChild(t)}r.forEach((e=>{const r=document.createElement("LI");r.dataset.taskId=e.id,r.classList.add("task");const l=document.createElement("P");l.textContent=e.name,l.ondblclick=function(){s(!0,{...e})};const u=document.createElement("DIV");u.classList.add("tasks-options");const m=document.createElement("BUTTON");m.type="button",m.classList.add("status-button"),m.classList.add(`${a[e.status]}`.toLowerCase()),m.textContent=n[e.status],m.dataset.taskStatus=e.status,m.ondblclick=function(){!function(t){const e="1"===t.status?"0":"1";t.status=e,d(t)}({...e})};const p=document.createElement("BUTTON");p.type="button",p.classList.add("deleteTask-button"),p.textContent="Eliminar",p.dataset.taskId=e.id,p.ondblclick=function(){!function(e){Swal.fire({title:"¿Eliminar tarea?",showCancelButton:!0,confirmButtonText:"Sí",cancelButtonText:"No"}).then((n=>{n.isConfirmed&&async function(e){const n=new FormData;n.append("id",e.id),n.append("status",e.status),n.append("name",e.name),n.append("project_id",o());try{const a="/api/tarea/eliminar",s=await fetch(a,{method:"POST",body:n}),o=await s.json();"success"===o.type&&(Swal.fire("¡Eliminado!",o.message,"success"),function(e){t=t.filter((t=>t.id!==e.id))}(e),i())}catch(t){console.log(t)}}(e)}))}({...e})},u.appendChild(m),u.appendChild(p),r.appendChild(l),r.appendChild(u),c.appendChild(r)}))}async function d(e){const{status:n,id:a,name:s}=e,d=new FormData;d.append("id",a),d.append("status",n),d.append("name",s),d.append("project_id",o());try{const n="/api/tarea/actualizar",a=await fetch(n,{method:"POST",body:d}),s=await a.json();"success"===s.type&&(c(document.querySelector(".modal"),0),Swal.fire("¡Actualizado!",s.message,"success"),function(e){t=t.map((t=>(t.id===e.id&&(t.status=e.status,t.name=e.name),t)))}(e),i())}catch(t){console.log(t)}}!function(n){n.forEach((n=>n.addEventListener("input",(function(n){const a=n.target.value;e=""===a?[]:t.filter((t=>t.status===a)),i()}))))}(document.querySelectorAll('.filters input[type="radio"]'))}();//# sourceMappingURL=tasks.js.map
